with children_movies (movieid, title, avg rating) as (select movies.movieid, title, avg(rating) as avg_rating from movies, ratings where genres ilike '%children%' and movies.movieid = ratings.movieid group by movies.movieid, title), comedy_avg_rating(avg_rating) as (select avg(rating) as avg_rating from movies, ratings where genres ilike *%comedy%' and movies.movieid = ratings.movieid select movieid, title from children movies, comedy_avg_rating where children_movies.avg_rating> comedy_avg_rating.avg_rating;